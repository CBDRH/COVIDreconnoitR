---
title: "changepoint"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{changepoint}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(covidrecon)
library(changepoint)
library(dplyr)
library(ggplot2)

version <- "1.8"
version_date <- lubridate::ymd("2020-02-28")


```

```{r covid}
covid <- covid_latest()

covid_high_incidence <- covid_high_incidence(covid)

covid_changepoint <- add_covid_change_point(covid_high_incidence)
  
```

```{r highlight-countries}
highlight_countries <- c("Japan",
                         "South_Korea",
                         "Singapore",
                         "Italy",
                         "Iran",
                         # "China",
                         "France",
                         "United_Kingdom",
                         "Sweden",
                         "Australia")

```

```{r covid-highlight}
covid_highlighted <- covid_changepoint %>% 
  filter(country_region %in% c(highlight_countries, 
                               "United_States_of_America", 
                               "Germany", 
                               "Denmark"))
```


```{r, fig.width=8, fig,height=16}
gg_covid_cases(covid_highlighted) +
  facet_grid(country_region ~ ., 
             scales = "free_y") +
  geom_vline(aes(xintercept = change_point_date)) 

gg_covid_cumulative_cases(covid_highlighted) +
  facet_grid(country_region ~ ., 
             scales = "free_y") +
  geom_vline(aes(xintercept = change_point_date)) 
```
