---
title: "COVID-19 trends and trajectories"
author:
  - name: Tim Churches 
    affiliation: South Western Sydney Clinical School, UNSW Medicine & Ingham Institute of Applied Medical Research, Liverpool, Sydney, Australia
    affiliation_url: https://swscs.med.unsw.edu.au
  - name: Nick Tierney 
    affiliation: Monash University
    affiliation_url: 
date: 03-20-2020
output:
  html_document:
    toc: true
    toc_depth: 3
    self_contained: true
vignette: >
  %\VignetteIndexEntry{cumulative-cases}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      cache = FALSE,
                      collapse = TRUE
                      tidy.opts = list(width.cutoff = 60),
                      tidy = TRUE)
```

```{r libraries}
library(covidrecon)
library(dplyr)
library(ggplot2)
library(lubridate)
library(tibble)
library(ggplot2)
library(ggthemes)
library(hrbrthemes)
library(gt)
library(deSolve)
library(EpiEstim)
library(incidence)
library(distcrete)
library(epitrix)
library(projections)
library(ggiraph)
library(ggrepel)

version <- "1.8"
version_date <- lubridate::ymd("2020-02-28")

```

https://blog.grattan.edu.au/2020/03/australian-governments-can-choose-to-slow-the-spread-of-coronavirus-but-they-must-act-immediately/

```{r get-latest-data}
covid <- covid_latest()
```

```{r high-incidence-countries}
high_incidence_countries <- covid_high_incidence(covid) %>% 
  mutate(alpha = ifelse(country_region == "Australia", 1, 0.7)) %>% 
  filter(normalised_date >= 0)
```

```{r select-countries}
selected_countries <- c("China",
                        "Singapore",
                        "Japan",
                        "Iran",
                        "Italy",
                        "Spain",
                        "US",
                        "United Kingdom",
                        "Australia",
                        "France",
                        "Korea, South")

```


```{r get-latest-data-highlight}
library(gghighlight)

gg_covid_cumulative(high_incidence_countries)

high_incidence_countries %>% 
  filter(country_region %in% c("Australia", "Italy")) %>% 
  add_country_label() %>% 
  gg_covid_cumulative() +
  geom_covid_country_label() +
  scale_x_continuous(expand = expansion(mult = c(0, 0.2)))
```

```{r highlight-countries}
highlight_countries <- c("Japan",
                         "Korea, South",
                         "Singapore",
                         "Italy",
                         "Iran",
                         "China",
                         "France",
                         "United Kingdom",
                         "Sweden",
                         "Australia")

high_incidence_countries_extra <- high_incidence_countries %>%
  covid_highlight_australia_plus(plus = highlight_countries) %>% 
  add_country_label() %>% 
  filter(normalised_date >= 0,
         country_region != "Cruise Ship")
```

## The "Grattan Institute" plot

```{r, layout="l-page"}
covid_date_normalised <- covid_highlighted %>%
  filter(date_since_100_cases >= 0,
         country_region != "Cruise Ship")

gg_covid_cumulative_exceed_100(covid_date_normalised) +
  labs(caption = 
  "CC BY-NC-SA Tim Churches (UNSW)
  Nick Tierney
  Data source: European CDC"
    )
  
```
